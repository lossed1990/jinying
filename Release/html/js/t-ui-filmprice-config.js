var UIFilmPriceConfig={createNew:function(){function t(){$.ajax({type:"POST",url:"film-getprice.zc",cache:!1,data:JSON.stringify("{'get':'all'}"),dataType:"json",success:function(t){r.val(t.price)},error:function(){toastr.error("获取覆膜单价失败,请刷新重试！")}})}function l(){e.dataTable({destroy:!0,ajax:function(t,l,a){$.ajax({type:"POST",url:m,cache:!1,data:JSON.stringify("{'get':'all'}"),dataType:"json",success:function(a){var s={};s.draw=t.draw,s.recordsTotal=a.recordsTotal,s.recordsFiltered=a.recordsFiltered,s.data=a.data,l(s)}})},columns:f})}var a={},s=$("#ui_body"),o=void 0,r=void 0,e=void 0,i=void 0,c=void 0,d=void 0,n=void 0,m="film-morerule-all.zc",u="film-morerule-add.zc",v="film-morerule-del.zc",f=[{data:"range"},{data:"count"},{data:null,className:"center",defaultContent:'<a id="delrow" href="#"><i class="fa fa-trash-o"></i>删除</a>'}];return a.load=function(){s.html('<div class="col-md-12 col-sm-12 col-xs-12">                <div class="x_panel">                    <div class="x_title">                        <h2>定价 <small>覆膜单价</small></h2>                        <div class="clearfix"></div>                    </div>                    <div class="x_content">                        <p class="text-muted font-13 m-b-30">                        功能描述：此处用来设置覆膜单价费（元/每平米）。                        </p>                        <div class="form-horizontal form-label-left">                            <div class="form-group">                                <label class="control-label col-md-1 col-sm-1 col-xs-12">单价(元)</label>                                <div class="col-md-11 col-sm-11 col-xs-12">                                    <input id="input_impress_price" type="text" class="form-control" placeholder="">                                </div>                            </div>                            <div class="ln_solid">                                <div class="form-group">                                    <div class="col-md-9 col-sm-9 col-xs-12 col-md-offset-1">                                        <button id="submit_set_price" class="btn btn-primary">设置</button>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>                <div class="x_panel">                <div class="x_title">                <h2>总览 <small>覆膜出数规则</small></h2>                <div class="clearfix"></div>                </div>                <div class="x_content">                <p class="text-muted font-13 m-b-30">                    功能描述：此处展示了目前所有的覆膜出数规则信息，您可通过该页面进行修改与删除。                </p>                <table id="table_filmmorerule" class="table table-striped table-bordered">                    <thead>                    <tr>                        <th>范围</th>                        <th>出数(个)</th>                        <th>操作</th>                    </tr>                    </thead>                    <tbody>                    </tbody>                </table>                </div>            </div>        </div>        <div class="col-md-12 col-sm-12 col-xs-12">            <div class="x_panel">                <div class="x_title">                    <h2>新增 <small>覆膜出数规则</small></h2>                    <div class="clearfix"></div>                </div>                <div class="x_content">                    <p class="text-muted font-13 m-b-30">                        功能描述：您可通过该页面新增覆膜出数规则。                    </p>                    <div class="form-horizontal form-label-left">                        <div class="form-group">                        <label class="control-label col-md-1 col-sm-1 col-xs-12">范围</label>                        <div class="col-md-2 col-sm-2 col-xs-12">                            <input id="input_souce_begin" type="text" class="form-control" placeholder="">                        </div>                        <label class="control-label col-md-1 col-sm-1 col-xs-12">~</label>                        <div class="col-md-2 col-sm-2 col-xs-12">                            <input id="input_souce_end" type="text" class="form-control" placeholder="">                        </div>                        <label class="control-label col-md-1 col-sm-1 col-xs-12">数量(个)</label>                        <div class="col-md-2 col-sm-2 col-xs-12">                            <input id="input_souce_count" type="text" class="form-control" placeholder="">                        </div>                        </div>                        <div class="ln_solid">                        </div>                        <div class="form-group">                        <div class="col-md-9 col-sm-9 col-xs-12 col-md-offset-1">                            <button id="submit_add_morerule" type="submit" class="btn btn-primary">新增</button>                            </div>                        </div>                    </div>                </div>            </div>            </div>'),o=$("#submit_set_price"),r=$("#input_impress_price"),e=$("#table_filmmorerule"),i=$("#submit_add_morerule"),c=$("#input_souce_begin"),d=$("#input_souce_end"),n=$("#input_souce_count"),o.on("click",function(){if(isNull(r.val().trim()))toastr.error("覆膜单价不能为空！");else if(isPrice(r.val().trim())){var l={price:parseFloat(r.val().trim())};$.ajax({type:"POST",url:"film-setprice.zc",cache:!1,data:JSON.stringify(l),dataType:"json",success:function(l){toastr.success("新覆膜单价设置成功"),t()},error:function(){toastr.error("新覆膜单价设置失败,请刷新重试！")}})}else toastr.error("覆膜单价输入不合法，仅能精确到小数点后两位！")}),t(),i.on("click",function(){var t;isNull(c.val().trim())?toastr.error("开始区间不能为空！"):isInt(c.val().trim())?isNull(d.val().trim())?toastr.error("结束区间不能为空！"):isInt(d.val().trim())?isNull(n.val().trim())?toastr.error("出数不能为空！"):isInt(n.val().trim())?(t={begin:parseInt(c.val().trim()),end:parseInt(d.val().trim()),count:parseInt(n.val().trim())},$.ajax({type:"POST",url:u,contentType:"application/json;charset=utf-8",data:JSON.stringify(t),dataType:"json",success:function(t){0==t.ok?(toastr.success("出数规则添加成功"),l(),c.val(""),d.val(""),n.val("")):toastr.error("出数规则添加失败,"+t.errorinfo)},error:function(){toastr.error("出数规则添加失败,请检查服务器及网络后重试！")}})):toastr.error("出数仅能输入数字！"):toastr.error("结束区间仅能输入数字！"):toastr.error("开始区间仅能输入数字！")}),e.on("click","a#delrow",function(t){t.preventDefault;var a=e.DataTable().row($(this).parents("tr")).data(),s="确定要删除区间["+a.range+"]吗?";swal({title:"提示",text:s,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定删除",cancelButtonText:"取消"},function(t){if(t){var s={range:a.range};$.ajax({url:v,type:"POST",dataType:"json",data:JSON.stringify(s),success:function(t){0==t.ok?(toastr.success("区间["+a.range+"]删除成功"),l()):toastr.error("区间["+a.range+"]删除失败,"+t.errorinfo)},error:function(){toastr.error("出数规则删除失败,请检查服务器及网络后重试！")}})}})}),l()},a}},g_oFilmPriceConfig=UIFilmPriceConfig.createNew();